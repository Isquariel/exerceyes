!function(){function a(){this.balls=document.querySelector(".balls"),this.score=document.querySelector(".score"),this.bodyWith=this.getElemWidth(document.body),this.checkPrefixes(),this.findKeyframes(),this.listenButtons(),this.listenKeyboard(),this.updateScore()}var b="animated",c="running",d="paused",e=2,f="move",g=6;a.prototype.play=function(){this.requestAnimationFrame(function(){var a=this.getWidth();this.createKeyframes(a),this.balls.classList.add(b),this.setPrefixedCss("animation-duration",this.getWidthPercentage(a)/e),this.setPrefixedCss("animation-play-state",c),this.spyStart(),this.__isRunning=!0})},a.prototype.pause=function(){this.requestAnimationFrame(function(){this.setPrefixedCss("animation-play-state",d),this.clearKeyframes(),this.spyStop(),this.__isRunning=!1})},a.prototype.isRunning=function(){return this.__isRunning},a.prototype.toggle=function(){this.isRunning()?this.pause():this.play()},a.prototype.move=function(a){var c;this.requestAnimationFrame(function(){this.pause(),c=this.getNearestWidthPoint(this.getWidthPercentage(),a),this.balls.classList.remove(b),this.balls.style.width=c+"%",this.updateScore()})},a.prototype.reset=function(){this.requestAnimationFrame(function(){this.balls.classList.remove(b),this.balls.style.width="",this.clearKeyframes(),this.spyStop(),this.updateScore()})},a.prototype.getWidth=function(){return this.getElemWidth(this.balls)},a.prototype.getElemWidth=function(a){var b=getComputedStyle(a);return parseInt(b.getPropertyValue("width"),10)},a.prototype.getWidthPercentage=function(a){return a=a||this.getWidth(),Math.round(a/this.bodyWith*100)},a.prototype.getNearestWidthPoint=function(a,b){return a%g===0?a+g*b:Math[b>0?"ceil":"floor"](a/g)*g},a.prototype.updateScore=function(){this.requestAnimationFrame(function(){this.score.innerHTML=this.getWidth()+" px"})},a.prototype.spyStart=function(){this.__spy&&this.spyStop(),this.__spy=setInterval(this.updateScore.bind(this),50)},a.prototype.spyStop=function(){clearInterval(this.__spy),delete this.__spy},a.prototype.listenKeyboard=function(){var a=this;window.addEventListener("keyup",function(b){switch(b.keyCode){case 219:a.move(-1);break;case 221:a.move(1);break;case 32:a.toggle();break;case 27:a.reset()}},!1)},a.prototype.listenButtons=function(){var a=this;Array.prototype.forEach.call(document.querySelectorAll(".action"),function(b){var c=b.getAttribute("data-action"),d=b.getAttribute("data-arg");d&&(d=parseInt(d,10)),b.addEventListener("click",function(){a[c](d)})})},a.prototype.checkPrefixes=function(){var a=this.balls;["","Webkit","Moz","O"].some(function(b){return a.style.hasOwnProperty(b+(b?"A":"a")+"nimation")?(this.__prefix=b,!0):void 0}.bind(this))},a.prototype.setPrefixedCss=function(a,b){var c=a.replace(/-(.)/g,function(a,b){return b.toUpperCase()});this.__prefix&&(c=this.__prefix+c[0].toUpperCase()+c.substr(1)),this.balls.style[c]=b},a.prototype.findKeyframes=function(){var a=this,b=document.styleSheets;Array.prototype.some.call(b,function(b){return Array.prototype.some.call(b.cssRules,function(b){return b.name===f?(a.keyframes=b,!0):void 0})})},a.prototype.clearKeyframes=function(){Array.prototype.forEach.call(this.keyframes.cssRules,function(a){this.keyframes.deleteRule(a.keyText)}.bind(this))},a.prototype.createKeyframes=function(a){this.keyframes.insertRule?(this.keyframes.insertRule("0% { width:"+a+"px }"),this.keyframes.insertRule("100% { width: 90% }")):(this.keyframes.appendRule("0% { width:"+a+"px }"),this.keyframes.appendRule("100% { width: 90% }"))},a.prototype.requestAnimationFrame=function(a){return window.requestAnimationFrame(a.bind(this))},new a}();