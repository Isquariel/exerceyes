"use strict";!function(){function t(t){var e,s=document.styleSheets;return Array.prototype.some.call(s,function(s){if(Array.prototype.forEach.call(s.cssRules,function(s){s.name===t&&(e=s)}),e)return!0}),e}function e(t){Array.prototype.forEach.call(t.cssRules,function(e){t.deleteRule(e.keyText)})}function s(t,e){t.appendRule?e.forEach(function(e){t.appendRule(e)}):e.forEach(function(e){t.insertRule(e)})}function n(t){return parseInt(getComputedStyle(t).width,10)}function i(){var e=document.querySelectorAll(".ball");this.balls=[e[0],e[1]],this.ballsContainer=document.querySelector(".balls"),this.score=document.querySelector(".score"),this.keyframes=t(a),this.getDimensions(),this.listenKeyboard(),this.listenButtons(),window.addEventListener("resize",function(){this.getDimensions()}.bind(this))}var o="animated",a="move",r=.1,l=20,c="running",h="paused",u="transform",p="animation-duration",y="animation-play-state";i.prototype.getDimensions=function(){var t=n(document.querySelector(".ball-left")),e=n(this.balls[0]);this.maxTranslate=t-e,this.maxPercentage=this.maxTranslate/e*100},i.prototype.play=function(){var t=this.maxTranslate-this.getTranslate();this.ballsContainer.classList.add(o),s(this.keyframes,["0% { transform: "+this.css(u)+" }","100% { transform: translateX("+this.maxTranslate+"px) }"]),this.css(p,t*r+"s"),this.css(y,c),this.spyStart(),this.__isRunning=!0},i.prototype.pause=function(){this.css(y,h),this.css(u,this.css(u)),this.ballsContainer.classList.remove(o),e(this.keyframes),this.spyStop(),this.__isRunning=!1},i.prototype.toggle=function(){this.__isRunning?this.pause():this.play()},i.prototype.reset=function(){this.ballsContainer.classList.remove(o),this.css(u,"none"),e(this.keyframes),this.spyStop(),this.updateScore()},i.prototype.together=function(){this.move(-1)},i.prototype.apart=function(){this.move(1)},i.prototype.move=function(t){var e=Math.round(this.getTranslate()/n(this.balls[0])*100);this.__isRunning&&this.pause();var s=this.getNearestWidthPoint(e,t);this.ballsContainer.classList.remove(o),this.css(u,"translateX("+s+"%)"),this.updateScore()},i.prototype.getNearestWidthPoint=function(t,e){var s;return s=t%l===0?t+l*e:e>0?Math.ceil(t/l)*l:(Math.floor(t/l)-1)*l,Math.min(Math.max(s,0),this.maxPercentage)},i.prototype.listenKeyboard=function(){var t=this,e={219:"together",221:"apart",32:"toggle",27:"reset"};window.addEventListener("keyup",function(s){var n=e[s.keyCode];n&&t[n]()},!1)},i.prototype.listenButtons=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll(".action"),function(e){e.addEventListener("click",function(){t[this.getAttribute("data-action")]()})})},i.prototype.css=function(t,e){return void 0===e?getComputedStyle(this.balls[0])[t]:(this.balls[0].style[t]=e,void(this.balls[1].style[t]=e))},i.prototype.getTranslate=function(){return this.css(u).split(",")[4]||0},i.prototype.updateScore=function(){window.requestAnimationFrame(function(){this.score.innerHTML=Math.round(2*this.getTranslate())}.bind(this))},i.prototype.spyStart=function(){this.__spy&&this.spyStop(),this.__spy=setInterval(this.updateScore.bind(this),50)},i.prototype.spyStop=function(){clearInterval(this.__spy),delete this.__spy},new i}();