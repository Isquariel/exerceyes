!function(){function t(){this.balls=document.querySelector(".balls"),this.score=document.querySelector(".score"),this.bodyWith=this.getElemWidth(document.body),this.checkPrefixes(),this.findKeyframes(),this.listenButtons(),this.listenKeyboard(),this.updateScore()}var e="animated",i="running",s="paused",n=2,r="move",o=6;t.prototype.play=function(){this.requestAnimationFrame(function(){var t=this.getWidth();this.createKeyframes(t),this.balls.classList.add(e),this.setPrefixedCss("animation-duration",this.getWidthPercentage(t)/n),this.setPrefixedCss("animation-play-state",i),this.spyStart(),this.__isRunning=!0})},t.prototype.pause=function(){this.requestAnimationFrame(function(){this.setPrefixedCss("animation-play-state",s),this.balls.style.width=this.getWidth()+"px",this.balls.classList.remove(e),this.clearKeyframes(),this.spyStop(),this.__isRunning=!1})},t.prototype.isRunning=function(){return this.__isRunning},t.prototype.toggle=function(){this.isRunning()?this.pause():this.play()},t.prototype.move=function(t){var i;this.requestAnimationFrame(function(){this.pause(),i=this.getNearestWidthPoint(this.getWidthPercentage(),t),this.balls.classList.remove(e),this.balls.style.width=i+"%",this.updateScore()})},t.prototype.reset=function(){this.requestAnimationFrame(function(){this.balls.classList.remove(e),this.balls.style.width="",this.clearKeyframes(),this.spyStop(),this.updateScore()})},t.prototype.getWidth=function(){return this.getElemWidth(this.balls)},t.prototype.getElemWidth=function(t){var e=getComputedStyle(t);return parseInt(e.getPropertyValue("width"),10)},t.prototype.getWidthPercentage=function(t){return t=t||this.getWidth(),Math.round(t/this.bodyWith*100)},t.prototype.getNearestWidthPoint=function(t,e){return t%o===0?t+o*e:Math[e>0?"ceil":"floor"](t/o)*o},t.prototype.updateScore=function(){this.requestAnimationFrame(function(){this.score.innerHTML=this.getWidth()+" px"})},t.prototype.spyStart=function(){this.__spy&&this.spyStop(),this.__spy=setInterval(this.updateScore.bind(this),50)},t.prototype.spyStop=function(){clearInterval(this.__spy),delete this.__spy},t.prototype.listenKeyboard=function(){var t=this;window.addEventListener("keyup",function(e){switch(e.keyCode){case 219:t.move(-1);break;case 221:t.move(1);break;case 32:t.toggle();break;case 27:t.reset()}},!1)},t.prototype.listenButtons=function(){var t=this;Array.prototype.forEach.call(document.querySelectorAll(".action"),function(e){var i=e.getAttribute("data-action"),s=e.getAttribute("data-arg");s&&(s=parseInt(s,10)),e.addEventListener("click",function(){t[i](s)})})},t.prototype.checkPrefixes=function(){var t=this.balls;["","Webkit","Moz","O"].some(function(e){return t.style.hasOwnProperty(e+(e?"A":"a")+"nimation")?(this.__prefix=e,!0):void 0}.bind(this))},t.prototype.setPrefixedCss=function(t,e){var i=t.replace(/-(.)/g,function(t,e){return e.toUpperCase()});this.__prefix&&(i=this.__prefix+i[0].toUpperCase()+i.substr(1)),this.balls.style[i]=e},t.prototype.findKeyframes=function(){var t=this,e=document.styleSheets;Array.prototype.some.call(e,function(e){return Array.prototype.forEach.call(e.cssRules,function(e){e.name===r&&(t.keyframes=e)}),t.keyframes?!0:void 0})},t.prototype.clearKeyframes=function(){Array.prototype.forEach.call(this.keyframes.cssRules,function(t){this.keyframes.deleteRule(t.keyText)}.bind(this))},t.prototype.createKeyframes=function(t){this.keyframes.appendRule?(this.keyframes.appendRule("0% { width:"+t+"px }"),this.keyframes.appendRule("100% { width: 90% }")):(this.keyframes.insertRule("0% { width:"+t+"px }"),this.keyframes.insertRule("100% { width: 90% }"))},t.prototype.requestAnimationFrame=function(t){return window.requestAnimationFrame(t.bind(this))},new t}();